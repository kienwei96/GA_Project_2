(this.webpackJsonpcontractorapp=this.webpackJsonpcontractorapp||[]).push([[87],{1058:function(e,t,a){"use strict";a.d(t,"a",(function(){return O})),a.d(t,"b",(function(){return p})),a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return C})),a.d(t,"e",(function(){return z})),a.d(t,"f",(function(){return M})),a.d(t,"g",(function(){return j}));var r=a(22),i=a(12),n=a(87);var o=function(e,t,a){return[t,a]},s=function(e,t,a){return[t,a,e[2]]},c=function(e,t,a){return[t,a,e[2],e[3]]};function l(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:e.extent?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function h(e,t){var a=e.scale,r=e.translate;return Math.round((t-r[0])/a[0])}function u(e,t){var a=e.scale,r=e.translate;return Math.round((r[1]-t)/a[1])}function m(e,t,a){for(var r,i,n,o,s=[],c=0;c<a.length;c++){var l=a[c];c>0?(n=h(e,l[0]),o=u(e,l[1]),n===r&&o===i||(s.push(t(l,n-r,o-i)),r=n,i=o)):(r=h(e,l[0]),i=u(e,l[1]),s.push(t(l,r,i)))}return s.length>0?s:null}function f(e,t){var a=e.scale,r=e.translate;return t*a[0]+r[0]}function d(e,t){var a=e.scale;return e.translate[1]-t*a[1]}function y(e,t,a){var i=new Array(a.length);if(!a.length)return i;var n=Object(r.a)(e.scale,2),o=n[0],s=n[1],c=f(e,a[0][0]),l=d(e,a[0][1]);i[0]=t(a[0],c,l);for(var h=1;h<a.length;h++){var u=a[h];c+=u[0]*o,l-=u[1]*s,i[h]=t(u,c,l)}return i}function g(e,t,a){for(var r=new Array(a.length),i=0;i<a.length;i++)r[i]=y(e,t,a[i]);return r}function v(e,t,a,r,i){return t.points=function(e,t,a,r){return m(e,a?r?c:s:r?s:o,t)}(e,a.points,r,i),t}function p(e,t,a,r,i){return t.x=h(e,a.x),t.y=u(e,a.y),t!==a&&(r&&(t.z=a.z),i&&(t.m=a.m)),t}function b(e,t,a,r,i){var n=function(e,t,a,r){for(var i=[],n=a?r?c:s:r?s:o,l=0;l<t.length;l++){var h=m(e,n,t[l]);h&&h.length>=3&&i.push(h)}return i.length?i:null}(e,a.rings,r,i);return n?(t.rings=n,t):null}function x(e,t,a,r,i){var n=function(e,t,a,r){for(var i=[],n=a?r?c:s:r?s:o,l=0;l<t.length;l++){var h=m(e,n,t[l]);h&&h.length>=2&&i.push(h)}return i.length?i:null}(e,a.paths,r,i);return n?(t.paths=n,t):null}function O(e,t){return e&&t?Object(n.f)(t)?p(e,{},t,!1,!1):Object(n.h)(t)?x(e,{},t,!1,!1):Object(n.g)(t)?b(e,{},t,!1,!1):Object(n.e)(t)?v(e,{},t,!1,!1):Object(n.d)(t)?function(e,t,a,r,i){return t.xmin=h(e,a.xmin),t.ymin=u(e,a.ymin),t.xmax=h(e,a.xmax),t.ymax=u(e,a.ymax),t!==a&&(r&&(t.zmin=a.zmin,t.zmax=a.zmax),i&&(t.mmin=a.mmin,t.mmax=a.mmax)),t}(e,{},t,!1,!1):null:null}function C(e,t,a,r,n){return Object(i.j)(a)&&(t.points=function(e,t,a,r){return y(e,a?r?c:s:r?s:o,t)}(e,a.points,r,n)),t}function z(e,t,a,r,n){return Object(i.i)(a)||(t.x=f(e,a.x),t.y=d(e,a.y),t!==a&&(r&&(t.z=a.z),n&&(t.m=a.m))),t}function M(e,t,a,r,n){return Object(i.j)(a)&&(t.rings=function(e,t,a,r){return g(e,a?r?c:s:r?s:o,t)}(e,a.rings,r,n)),t}function j(e,t,a,r,n){return Object(i.j)(a)&&(t.paths=function(e,t,a,r){return g(e,a?r?c:s:r?s:o,t)}(e,a.paths,r,n)),t}},1268:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var r=a(18),i=a(22),n=a(4),o=a(5),s=a(1051),c=a(1049),l=a(1094),h=a(137),u=function(){function e(){Object(n.a)(this,e)}return Object(o.a)(e,[{key:"dispose",value:function(){this._rasterizationCanvas=null}},{key:"rasterizeJSONResource",value:function(e,t,a){if(this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),"simple-fill"===e.type||"esriSFS"===e.type){var r=s.c.rasterizeSimpleFill(this._rasterizationCanvas,e.style,t),n=Object(i.a)(r,3),o=n[0];return{size:[n[1],n[2]],image:new Uint32Array(o.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if("simple-line"===e.type||"esriSLS"===e.type){var h=s.c.rasterizeSimpleLine(e.style,e.cap),u=Object(i.a)(h,3),m=u[0];return{size:[u[1],u[2]],image:new Uint32Array(m.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}var f,d,y;if("simple-marker"===e.type||"esriSMS"===e.type||"line-marker"===e.type?(f=s.a.fromSimpleMarker(e),y=Object(l.c)(f)):"CIMHatchFill"===e.type?(f=s.a.fromCIMHatchFill(e),d=new c.a(f.frame.xmin,-f.frame.ymax,f.frame.xmax-f.frame.xmin,f.frame.ymax-f.frame.ymin)):e.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===e.markerPlacement.type?(f=s.a.fromCIMInsidePolygon(e),d=new c.a(f.frame.xmin,-f.frame.ymax,f.frame.xmax-f.frame.xmin,f.frame.ymax-f.frame.ymin)):(f=e,y=Object(l.c)(f)),y&&!a){var g=Object(l.a)(y),v=Object(i.a)(g,3),p=v[0],b=v[1],x=v[2];return p?{size:[b,x],image:new Uint32Array(p.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}var O=s.a.rasterize(this._rasterizationCanvas,f,d,!a),C=Object(i.a)(O,5),z=C[0],M=C[1],j=C[2],w=C[3],I=C[4];return z?{size:[M,j],image:new Uint32Array(z.buffer),sdf:!1,simplePattern:!1,anchorX:w,anchorY:I}:null}},{key:"rasterizeImageResource",value:function(e,t,a,n){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),this._rasterizationCanvas.width=e,this._rasterizationCanvas.height=t;var o=this._rasterizationCanvas.getContext("2d");a instanceof ImageData?o.putImageData(a,0,0):(a.setAttribute("width","".concat(e,"px")),a.setAttribute("height","".concat(t,"px")),o.drawImage(a,0,0,e,t));var s,c=o.getImageData(0,0,e,t),l=new Uint8Array(c.data);if(n){var u,m=Object(r.a)(n);try{for(m.s();!(u=m.n()).done;){var f=u.value;if(f&&f.oldColor&&4===f.oldColor.length&&f.newColor&&4===f.newColor.length){var d=Object(i.a)(f.oldColor,4),y=d[0],g=d[1],v=d[2],p=d[3],b=Object(i.a)(f.newColor,4),x=b[0],O=b[1],C=b[2],z=b[3];if(y===x&&g===O&&v===C&&p===z)continue;for(var M=0;M<l.length;M+=4)y===l[M]&&g===l[M+1]&&v===l[M+2]&&p===l[M+3]&&(l[M]=x,l[M+1]=O,l[M+2]=C,l[M+3]=z)}}}catch(R){m.e(R)}finally{m.f()}}for(var j=0;j<l.length;j+=4)s=l[j+3]/255,l[j]=l[j]*s,l[j+1]=l[j+1]*s,l[j+2]=l[j+2]*s;var w=l,I=e,k=t,P=512;if(I>=P||k>=P){var S=I/k;S>1?(I=P,k=Math.round(P/S)):(k=P,I=Math.round(P*S)),w=new Uint8Array(4*I*k);var _=new Uint8ClampedArray(w.buffer);Object(h.j)(l,e,t,_,I,k,!1)}return{size:[I,k],image:new Uint32Array(w.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}}]),e}()},1492:function(e,t,a){"use strict";a.r(t),a.d(t,"previewCIMSymbol",(function(){return A}));var r=a(10),i=a.n(r),n=a(16),o=a(49),s=a(18),c=a(4),l=a(5),h=a(75),u=a(33),m=a(116),f=a(87),d=a(1071),y=a(1268),g=a(22);var v=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,[{key:"rasterizeText",value:function(e,t){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));var a=this._textRasterizationCanvas,r=a.getContext("2d");this.setFontProperties(r,t),this.parameters=t,this.textLines=e.split(/\r?\n/),this.lineHeight=this.computeLineHeight();var i=this.computeTextWidth(r,t),n=this.lineHeight*this.textLines.length;a.width=i,a.height=n,this.renderedLineHeight=Math.round(this.lineHeight*t.pixelRatio),this.renderedHaloSize=t.halo.size*t.pixelRatio,this.renderedWidth=i*t.pixelRatio,this.renderedHeight=n*t.pixelRatio,this.fillStyle=function(e){return"rgba(".concat(e.slice(0,3).toString(),",").concat(e[3],")")}(t.color),this.haloStyle=function(e){return"rgb(".concat(e.slice(0,3).toString(),")")}(t.halo.color);var o=this.renderedLineHeight,c=this.renderedHaloSize;this.setFontProperties(r,t);var l=function(e,t){return"center"===e?.5*t:"right"===e?t:0}(r.textAlign,this.renderedWidth)+c,h=c,u=0,m=0;c>0&&this.renderHalo(r,l,h,u,m,t),m+=h,u+=l;var f,d=Object(s.a)(this.textLines);try{for(d.s();!(f=d.n()).done;){var y=f.value;r.globalCompositeOperation="destination-out",r.fillStyle="rgb(0, 0, 0)",r.fillText(y,u,m),r.globalCompositeOperation="source-over",r.fillStyle=this.fillStyle,r.fillText(y,u,m),m+=o}}catch(x){d.e(x)}finally{d.f()}var g=r.getImageData(0,0,this.renderedWidth,this.renderedHeight),v=new Uint8Array(g.data);if(t.premultiplyColors)for(var p,b=0;b<v.length;b+=4)p=v[b+3]/255,v[b]=v[b]*p,v[b+1]=v[b+1]*p,v[b+2]=v[b+2]*p;return{size:[this.renderedWidth,this.renderedHeight],image:new Uint32Array(v.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}},{key:"renderHalo",value:function(e,t,a,r,i,n){var o=this.renderedWidth,s=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas")),this._haloRasterizationCanvas.width=o,this._haloRasterizationCanvas.height=s;var c=this._haloRasterizationCanvas,l=c.getContext("2d");l.clearRect(0,0,o,s),this.setFontProperties(l,n),l.fillStyle=this.haloStyle,l.strokeStyle=this.haloStyle;var h=this.renderedHaloSize<3;l.lineJoin=h?"miter":"round",h?this.renderHaloEmulated(l,t,a):this.renderHaloNative(l,t,a),e.globalAlpha=this.parameters.halo.color[3],e.drawImage(c,0,0,o,s,r,i,o,s),e.globalAlpha=1}},{key:"renderHaloEmulated",value:function(e,t,a){var r,i=this.renderedLineHeight,n=this.renderedHaloSize,o=Object(s.a)(this.textLines);try{for(o.s();!(r=o.n()).done;){var c,l=r.value,h=Object(s.a)(p);try{for(h.s();!(c=h.n()).done;){var u=Object(g.a)(c.value,2),m=u[0],f=u[1];e.fillText(l,t+n*m,a+n*f)}}catch(d){h.e(d)}finally{h.f()}a+=i}}catch(d){o.e(d)}finally{o.f()}}},{key:"renderHaloNative",value:function(e,t,a){var r,i=this.renderedLineHeight,n=this.renderedHaloSize,o=Object(s.a)(this.textLines);try{for(o.s();!(r=o.n()).done;){for(var c=r.value,l=2*n,h=0;h<5;h++){var u=.6+.1*h;e.lineWidth=u*l,e.strokeText(c,t,a)}a+=i}}catch(m){o.e(m)}finally{o.f()}}},{key:"setFontProperties",value:function(e,t){var a,r=t.font,i="".concat(r.style," ").concat(r.weight," ").concat(Object(o.c)(t.size*t.pixelRatio),"px ").concat(r.family,", sans-serif");switch(e.font=i,e.textBaseline="top",t.horizontalAlignment){default:a="left";break;case"right":a="right";break;case"center":a="center"}e.textAlign=a}},{key:"computeTextWidth",value:function(e,t){var a,r=0,i=Object(s.a)(this.textLines);try{for(i.s();!(a=i.n()).done;){var n=a.value;r=Math.max(r,e.measureText(n).width)}}catch(c){i.e(c)}finally{i.f()}var o=t.font;return("italic"===o.style||"oblique"===o.style||"string"==typeof o.weight&&("bold"===o.weight||"bolder"===o.weight)||"number"==typeof o.weight&&o.weight>600)&&(r+=.3*e.measureText("A").width),r+=2*this.parameters.halo.size,Math.round(r)}},{key:"computeLineHeight",value:function(){var e=1.275*this.parameters.size;return Math.round(e+2*this.parameters.halo.size)}}]),e}();for(var p=[],b=0;b<360;b+=22.5)p.push([Math.cos(Math.PI*b/180),Math.sin(Math.PI*b/180)]);var x,O,C=a(137),z=a(745),M=a(687);(O=x||(x={})).Legend="legend",O.Preview="preview";var j=function(e,t,a){if(e&&e.targetSize){var r;if(a){var i=Math.max(a.frame.xmax-a.frame.xmin,a.frame.ymax-a.frame.ymin);r=e.targetSize/Object(o.c)(i)}else r=e.targetSize/t.referenceSize;return r}return e&&e.scaleFactor?e.scaleFactor:1},w={fill:{legend:{frame:{xmax:15,xmin:0,ymax:15,ymin:0},geometry:{rings:[[[0,15],[15,7.5],[15,0],[0,0],[0,15]]]},canvasPaths:{rings:[[[0,15],[0,0],[15,7.5],[15,15],[0,15]]]}},preview:{frame:{xmax:100,xmin:0,ymax:100,ymin:0},geometry:{rings:[[[0,100],[100,100],[100,0],[0,0],[0,100]]]},canvasPaths:{rings:[[[0,100],[0,0],[100,0],[100,100],[0,100]]]}}},stroke:{legend:{frame:{xmax:24,xmin:0,ymax:-2,ymin:2},geometry:{paths:[[[0,0],[12,0],[24,0]]]},canvasPaths:{paths:[[[0,2],[12,2],[24,2]]]}},preview:{frame:{xmax:100,xmin:0,ymax:-2,ymin:2},geometry:{paths:[[[0,0],[50,0],[100,0]]]},canvasPaths:{paths:[[[0,2],[50,2],[100,2]]]}}}},I=function(){function e(t,a){Object(c.a)(this,e),this._spatialReference=t,this._avoidSDF=a,this._resourceCache=new Map,this._rasterizer=new y.a,this._textRasterizer=new v,this._pictureMarkerCache=new Map}return Object(l.a)(e,[{key:"rasterizeCIMSymbolAsync",value:function(){var e=Object(n.a)(i.a.mark((function e(t,a,r,n,o,s,c,l){var h;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=n||(a?null!=a.centroid?"esriGeometryPolygon":Object(f.c)(a.geometry):null)||P(t),e.next=3,this.analyzeCIMSymbol(t,a?k(a.attributes):null,r,n,l);case 3:return h=e.sent,e.abrupt("return",this.rasterizeCIMSymbol(h,a,n,o,s,c));case 5:case"end":return e.stop()}}),e,this)})));return function(t,a,r,i,n,o,s,c){return e.apply(this,arguments)}}()},{key:"analyzeCIMSymbol",value:function(){var e=Object(n.a)(i.a.mark((function e(t,a,r,n,o){var s,c,l,h,m,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=[],c=a?{geometryType:n,spatialReference:this._spatialReference,fields:a}:null,e.next=3,Object(d.b)(t.data,c,s,this._avoidSDF);case 3:for(Object(u.v)(o),h=0,m=s;h<m.length;h++)"CIMPictureMarker"!==(f=m[h]).cim.type&&"CIMPictureFill"!==f.cim.type&&"CIMPictureStroke"!==f.cim.type||(l||(l=[]),l.push(this.fetchPictureMarkerResource(f,o))),r&&"text"===f.type&&"string"==typeof f.text&&f.text.indexOf("[")>-1&&(f.text=Object(C.c)(r,f.text,f.cim.textCase));if(e.t0=l,!e.t0){e.next=9;break}return e.next=9,Promise.all(l);case 9:return e.abrupt("return",s);case 10:case"end":return e.stop()}}),e,this)})));return function(t,a,r,i,n){return e.apply(this,arguments)}}()},{key:"fetchPictureMarkerResource",value:function(){var e=Object(n.a)(i.a.mark((function e(t,a){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.materialHash,this._pictureMarkerCache.get(r)){e.next=6;break}return e.next=4,Object(h.default)(t.cim.url,{responseType:"image",signal:a&&a.signal});case 4:n=e.sent.data,this._pictureMarkerCache.set(r,n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"rasterizeCIMSymbol",value:function(e,t,a,r,i,n){var o,c=[],l=Object(s.a)(e);try{for(l.s();!(o=l.n()).done;){var h=o.value;r&&"function"==typeof r.scaleFactor&&(r.scaleFactor=r.scaleFactor(t,i,n));var u=this._getRasterizedResource(h,t,a,r,i,n);if(u){var m=0,f=u.anchorX||0,d=u.anchorY||0,y=!1,g=0,v=0;if("esriGeometryPoint"===a){var p=j(r,h,null);if(g=Object(C.d)(h.offsetX,t,i,n)*p||0,v=Object(C.d)(h.offsetY,t,i,n)*p||0,"marker"===h.type)m=Object(C.d)(h.rotation,t,i,n)||0,y=!!h.rotateClockwise&&h.rotateClockwise;else if("text"===h.type){if(m=Object(C.d)(h.angle,t,i,n)||0,void 0!==h.horizontalAlignment)switch(h.horizontalAlignment){case"left":f=-.5;break;case"right":f=.5;break;default:f=0}if(void 0!==h.verticalAlignment)switch(h.verticalAlignment){case"top":d=.5;break;case"bottom":d=-.5;break;case"baseline":d=-.25;break;default:d=0}}}null!=u&&c.push({angle:m,rotateClockWise:y,anchorX:f,anchorY:d,offsetX:g,offsetY:v,rasterizedResource:u})}}}catch(b){l.e(b)}finally{l.f()}return this.getSymbolImage(c)}},{key:"getSymbolImage",value:function(e){for(var t=document.createElement("canvas"),a=t.getContext("2d"),r=0,i=0,n=0,s=0,c=[],l=0;l<e.length;l++){var h=e[l],u=h.rasterizedResource;if(u){var m=u.size,f=h.offsetX,d=h.offsetY,y=h.anchorX,g=h.anchorY,v=h.rotateClockWise||!1,p=h.angle,b=Object(o.c)(f)-m[0]*(.5+y),x=Object(o.c)(d)-m[1]*(.5+g),O=b+m[0],C=x+m[1];if(p){v&&(p=-p);var z=Math.sin(p*Math.PI/180),j=Math.cos(p*Math.PI/180),w=b*j-x*z,I=b*z+x*j,k=b*j-C*z,P=b*z+C*j,S=O*j-C*z,_=O*z+C*j,R=O*j-x*z,A=O*z+x*j;b=Math.min(w,k,S,R),x=Math.min(I,P,_,A),O=Math.max(w,k,S,R),C=Math.max(I,P,_,A)}r=b<r?b:r,i=x<i?x:i,n=O>n?O:n,s=C>s?C:s;var D=a.createImageData(u.size[0],u.size[1]);D.data.set(new Uint8ClampedArray(u.image.buffer));var H={offsetX:f,offsetY:d,rotateClockwise:v,angle:p,rasterizedImage:D,anchorX:y,anchorY:g};c.push(H)}}t.width=n-r,t.height=s-i;for(var F=-r,L=s,T=0;T<c.length;T++){var X=c[T],Y=this._imageDataToCanvas(X.rasterizedImage),U=X.rasterizedImage.width,W=X.rasterizedImage.height,E=F-U*(.5+X.anchorX),G=L-W*(.5-X.anchorY);if(X.angle){var J=(360-X.angle)*Math.PI/180;a.save(),a.translate(Object(o.c)(X.offsetX),-Object(o.c)(X.offsetY)),a.translate(F,L),a.rotate(J),a.translate(-F,-L),a.drawImage(Y,E,G),a.restore()}else a.drawImage(Y,E+Object(o.c)(X.offsetX),G-Object(o.c)(X.offsetY))}var N=new M.b({x:F/t.width-.5,y:L/t.height-.5});return{imageData:0!==t.width&&0!==t.height?a.getImageData(0,0,t.width,t.height):a.createImageData(1,1),anchorPosition:N}}},{key:"_imageDataToCanvas",value:function(e){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));var t=this._imageDataCanvas,a=t.getContext("2d");return t.width=e.width,t.height=e.height,a.putImageData(e,0,0),t}},{key:"_imageTo32Array",value:function(e,t,a){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));var r=this._imageDataCanvas,i=r.getContext("2d");return r.width=t,r.height=a,i.drawImage(e,0,0,t,a),new Uint32Array(i.getImageData(0,0,t,a).data.buffer)}},{key:"_getRasterizedResource",value:function(e,t,a,r,i,n){var o,s,c,l;if("esriGeometryPolyline"===a||"esriGeometryPolygon"===a){var h=r&&r.style?r.style:x.Legend,u="esriGeometryPolyline"===a?w.stroke[h]:w.fill[h];if("line"===e.type){var f;if("CIMSolidStroke"!==e.cim.type){if("CIMPictureStroke"===e.cim.type){var d=Object(C.d)(e.width,t,i,n),y=this._getPictureResource(e,d),g=y.image,v=y.width,p=y.height;return this._rasterizePictureResource(e,g,v,p,u,d)}return null}o=(f=S(e,t,i,n)).analyzedCIM,c=f.hash,s=this._embedCIMLayerInVectorMarker(o,u)}else if("marker"===e.type){if("CIMPictureMarker"===e.cim.type)return null;if("CIMVectorMarker"!==e.cim.type)return null;e.cim.offsetX=Object(C.d)(e.offsetX,t,i,n),e.cim.offsetY=Object(C.d)(e.offsetY,t,i,n),e.cim.rotation=Object(C.d)(e.rotation,t,i,n),e.cim.markerPlacement=e.markerPlacement,o=S(e,t,i,n).analyzedCIM,c=Object(m.b)(JSON.stringify(o)).toString(),s=this._embedCIMLayerInVectorMarker(o,u)}else{if("text"===e.type)return null;if("fill"===e.type){var b;if("CIMHatchFill"===e.cim.type||"CIMVectorMarker"===e.cim.type||"CIMPictureMarker"===e.cim.type||"CIMPictureFill"===e.cim.type){var O,M,I,k=e.cim.size||e.cim.height;if("CIMPictureMarker"===e.cim.type||"CIMPictureFill"===e.cim.type){var P=this._getPictureResource(e,k);O=P.image,M=P.width,I=P.height}else{var _=S(e,t,i,n);o=_.analyzedCIM,c=_.hash;var R=this._rasterizer.rasterizeJSONResource(o,1,this._avoidSDF);O=R.image,M=R.size[0],I=R.size[1]}return this._rasterizePictureResource(e,O,M,I,u,null)}if("CIMSolidFill"!==e.cim.type)return null;o=(b=S(e,t,i,n)).analyzedCIM,c=b.hash,s=this._embedCIMLayerInVectorMarker(o,u)}}}else{if("text"===e.type)return l=this._rasterizeTextResource(e,t,r,i,n);var A=S(e,t,i,n);o=A.analyzedCIM,c=A.hash;var D=j(r,e,null);if("CIMPictureMarker"===e.cim.type){var H=Object(C.d)(e.size,t,i,n)*D,F=this._getPictureResource(e,H);return l={image:F.image,size:[F.width,F.height],sdf:!1,simplePattern:!1,anchorX:e.anchorPoint?e.anchorPoint.x:0,anchorY:e.anchorPoint?e.anchorPoint.y:0}}Object(z.c)(o,D,{preserveOutlineWidth:!1}),s=o}c+=a,r&&(c+=JSON.stringify(r));var L=this._resourceCache;return L.has(c)?L.get(c):(l=this._rasterizer.rasterizeJSONResource(s,window.devicePixelRatio||1,this._avoidSDF),L.set(c,l),l)}},{key:"_rasterizeTextResource",value:function(e,t,a,r,i){var n=j(a,e,null),o=Object(C.d)(e.text,t,r,i);if(!o||0===o.length)return null;var s=Object(C.d)(e.fontName,t,r,i),c=Object(C.d)(e.style,t,r,i),l=Object(C.d)(e.weight,t,r,i),h=Object(C.d)(e.decoration,t,r,i),u=Object(C.d)(e.size,t,r,i)*n,m=Object(C.d)(e.horizontalAlignment,t,r,i),f=Object(C.d)(e.verticalAlignment,t,r,i),d=Object(C.b)(Object(C.d)(e.color,t,r,i)),y=Object(C.b)(Object(C.d)(e.outlineColor,t,r,i)),g={color:d,size:u,horizontalAlignment:m,verticalAlignment:f,font:{family:s,style:c,weight:l,decoration:h},halo:{size:Object(C.d)(e.outlineSize,t,r,i)||0,color:y,style:c},pixelRatio:1,premultiplyColors:!this._avoidSDF};return this._textRasterizer.rasterizeText(o,g)}},{key:"_rasterizePictureResource",value:function(e,t,a,r,i,n){var c=document.createElement("canvas"),l=c.getContext("2d");c.height=Object(o.c)(Math.max(Math.abs(i.frame.ymax-i.frame.ymin),n)),c.width=Object(o.c)(Math.abs(i.frame.xmax-i.frame.xmin));var h=l.createImageData(a,r);h.data.set(new Uint8ClampedArray(t.buffer));var u=this._imageDataToCanvas(h),m=l.createPattern(u,"repeat"),d=Math.cos((-e.cim.rotation||0)*Math.PI/180),y=Math.sin((-e.cim.rotation||0)*Math.PI/180);m.setTransform({m11:d,m12:y,m21:-y,m22:d,m41:Object(o.c)(e.cim.offsetX)||0,m42:Object(o.c)(e.cim.offsetY)||0});var g,v,p,b=i.canvasPaths;Object(f.g)(b)?(g=b.rings,l.fillStyle=m,v=l.fill,p=["evenodd"]):Object(f.h)(b)&&(g=b.paths,l.strokeStyle=m,l.lineWidth=n,v=l.stroke,g[0][0][1]=c.height/2,g[0][1][1]=c.height/2),l.beginPath();var x,O=Object(s.a)(g);try{for(O.s();!(x=O.n()).done;){var C=x.value,z=C?C.length:0;if(z>1){var M=C[0];l.moveTo(Object(o.c)(M[0]),Object(o.c)(M[1]));for(var j=1;j<z;++j)M=C[j],l.lineTo(Object(o.c)(M[0]),Object(o.c)(M[1]));l.closePath()}}}catch(k){O.e(k)}finally{O.f()}v.apply(l,p);var w=l.getImageData(0,0,c.width,c.height),I=new Uint8Array(w.data);return{size:[c.width,c.height],image:new Uint32Array(I.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}},{key:"_getPictureResource",value:function(e,t){var a=this._pictureMarkerCache.get(e.materialHash);if(!a)return null;var r=a.height/a.width,i=t?r>1?Object(o.c)(t):Object(o.c)(t)/r:a.width,n=t?r>1?Object(o.c)(t)*r:Object(o.c)(t):a.height;return{image:this._imageTo32Array(a,i,n),width:i,height:n}}},{key:"_embedCIMLayerInVectorMarker",value:function(e,t){var a=Object(f.g)(t.geometry)?"CIMPolygonSymbol":"CIMLineSymbol";return{type:"CIMVectorMarker",frame:t.frame,markerGraphics:[{type:"CIMMarkerGraphic",geometry:t.geometry,symbol:{type:a,symbolLayers:[e]}}]}}}]),e}();function k(e){return(e?Object.keys(e):[]).map((function(t){return{name:t,alias:t,type:"string"==typeof e[t]?"esriFieldTypeString":"esriFieldTypeDouble"}}))}function P(e){if(!(e&&e.data&&e.data.symbol))return null;switch(e.data.symbol.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function S(e,t,a,r){var i,n;return"function"==typeof e.materialHash?(i=(0,e.materialHash)(t,a,r),n=Object(d.a)(e.cim,e.materialOverrides)):(i=e.materialHash,n=e.cim),{analyzedCIM:n,hash:i}}var _=new I(null,!0),R=120;function A(e){return D.apply(this,arguments)}function D(){return D=Object(n.a)(i.a.mark((function e(t){var a,r,n,s,c,l,h,u,m,f,d,y,g,v,p,b,x,O,C,M=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=M.length>1&&void 0!==M[1]?M[1]:{},r=a.size,n=a.maxSize,s=a.node,c=a.opacity,l=a.cimOptions||a,h=l.feature,u=l.fieldMap,m=l.geometryType,f=l.style,d=Object(z.b)(t),(y=Math.min(null!=r?r:d,null!=n?n:Object(o.d)(R)))!==d&&(t=t.clone(),Object(z.d)(t,y,{preserveOutlineWidth:!0})),g=3,t&&t.data&&t.data.symbol&&"CIMPointSymbol"!==t.data.symbol.type&&(g=1),e.next=7,_.rasterizeCIMSymbolAsync(t,h,u,m,{scaleFactor:g,style:f});case 7:return v=e.sent,(p=document.createElement("canvas")).width=v.imageData.width,p.height=v.imageData.height,p.getContext("2d").putImageData(v.imageData,0,0),b=p.width/g,x=p.height/g,null==r||null!=(null==a?void 0:a.scale)&&!(null==a?void 0:a.scale)||(b=(O=b/x)<=1?Math.ceil(y*O):y,x=O<=1?y:Math.ceil(y/O)),C=new Image(b,x),e.abrupt("return",(C.src=p.toDataURL(),null!=c&&(C.style.opacity="".concat(c)),s&&s.appendChild(C),C));case 15:case"end":return e.stop()}}),e)}))),D.apply(this,arguments)}}}]);
//# sourceMappingURL=87.475b84f4.chunk.js.map